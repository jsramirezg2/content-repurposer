{% extends "base.html" %}

{% block content %}
  <h2 class="text-3xl font-bold mb-6 text-center">Repurpose Your Content</h2>

  <!-- Loading spinner -->
    <div id="spinner" class="fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50 hidden">
    <svg class="animate-spin h-12 w-12 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor"
        d="M4 12a8 8 0 018-8v8H4z">
      </path>
    </svg>
  </div>


  <form method="POST" enctype="multipart/form-data" class="bg-white p-6 rounded shadow-md max-w-2xl mx-auto space-y-6">
    <div>
      <label for="input_type" class="block text-sm font-medium mb-1">Choose input type:</label>
      <select name="input_type" id="input_type" required class="w-full border rounded p-2">
        <option value="text">Text</option>
        <option value="youtube_url">YouTube URL</option>
        <option value="video_file">Video File</option>
      </select>
    </div>

    <div id="text_input">
      <label for="content" class="block text-sm font-medium mb-1">Paste your content:</label>
      <textarea name="content" rows="6" class="w-full border rounded p-2"></textarea>
    </div>

    <div id="youtube_input" style="display: none;">
      <label for="youtube_url" class="block text-sm font-medium mb-1">YouTube URL:</label>
      <input type="url" name="youtube_url" class="w-full border rounded p-2">
    </div>

    <div id="video_input" style="display: none;">
      <label for="video_file" class="block text-sm font-medium mb-1">Upload Video File:</label>
      <input type="file" name="video_file" accept="video/*" class="w-full border rounded p-2">
    </div>

    <div>
      <label for="platform" class="block text-sm font-medium mb-1">Choose platform:</label>
      <select name="platform" required class="w-full border rounded p-2">
        <option value="summary">Summary</option>
        <option value="twitter">Twitter Thread</option>
        <option value="linkedin">LinkedIn Post</option>
      </select>
    </div>

    <div>
      <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-2 rounded hover:bg-blue-700">
        Generate
      </button>
    </div>
  </form>

  <script>
    const inputType = document.getElementById('input_type');
    const textInput = document.getElementById('text_input');
    const youtubeInput = document.getElementById('youtube_input');
    const videoInput = document.getElementById('video_input');

    inputType.addEventListener('change', function () {
      textInput.style.display = this.value === 'text' ? 'block' : 'none';
      youtubeInput.style.display = this.value === 'youtube_url' ? 'block' : 'none';
      videoInput.style.display = this.value === 'video_file' ? 'block' : 'none';
    });


    // loading spinner
    const form = document.querySelector('form');
    const spinner = document.getElementById('spinner');

    form.addEventListener('submit', () => {
      spinner.classList.remove('hidden');
    });

  </script>
{% endblock %}
